@import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@500;600;700&family=Inter:wght@400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --color-bg-start: 250 227 236;
  --color-bg-middle: 248 216 229;
  --color-bg-end: 243 201 220;
  --color-surface: 255 246 251;
  --color-border: 239 182 206;
  --color-ink: 33 26 42;
  --color-muted: 99 83 107;
  --color-primary: 231 73 129;
  --color-primary-strong: 250 113 146;
  --color-accent: 252 230 240;
  --color-focus: 149 106 130;

  --radius-card: 2rem;
  --radius-button: 1.1rem;

  --shadow-soft: 0 18px 38px -28px rgb(95 24 48 / 0.38);
  --shadow-lift: 0 30px 50px -26px rgb(76 16 40 / 0.44);
  --shadow-glow: 0 24px 46px -26px rgb(222 104 146 / 0.68);

  --space-gutter: clamp(1.1rem, 2.2vw, 2rem);
  --space-section: clamp(1.3rem, 3vw, 2.7rem);
  --space-card: clamp(1.2rem, 2.8vw, 2.4rem);
}

@layer base {
  * {
    @apply box-border;
  }

  body {
    @apply m-0 min-h-screen font-body text-ink antialiased;
    background: linear-gradient(165deg, rgb(var(--color-bg-start)) 0%, rgb(var(--color-bg-middle)) 48%, rgb(var(--color-bg-end)) 100%);
  }

  #root {
    @apply min-h-screen;
  }

  h1,
  h2,
  h3 {
    @apply font-heading tracking-tight text-ink;
  }

  p {
    @apply leading-relaxed text-muted;
  }
}

@layer components {
  .app-shell {
    position: relative;
    background:
      radial-gradient(58rem 40rem at -8% -2%, rgb(255 255 255 / 0.3) 0%, transparent 42%),
      radial-gradient(52rem 40rem at 104% 94%, rgb(255 245 249 / 0.36) 0%, transparent 47%),
      linear-gradient(165deg, #ffe5ef 0%, #fdd2e2 47%, #f7c0d8 100%);
    transition:
      background 680ms cubic-bezier(0.16, 0.9, 0.29, 1),
      filter 420ms ease;
  }

  .app-shell::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    opacity: 0.08;
    background:
      radial-gradient(22rem 14rem at 8% 18%, rgb(255 255 255 / 0.4), transparent 70%),
      radial-gradient(28rem 16rem at 92% 78%, rgb(255 255 255 / 0.38), transparent 72%);
    transition: opacity 420ms ease, background 620ms ease;
  }

  .scene-ask {
    background:
      radial-gradient(56rem 36rem at -8% 0%, rgb(255 255 255 / 0.28), transparent 45%),
      radial-gradient(48rem 34rem at 104% 96%, rgb(255 250 252 / 0.3), transparent 50%),
      linear-gradient(165deg, #ffe7f0 0%, #fdd6e5 46%, #f8c5dd 100%);
  }

  .scene-no-1 {
    background:
      radial-gradient(56rem 36rem at -8% 0%, rgb(255 255 255 / 0.14), transparent 45%),
      radial-gradient(48rem 34rem at 104% 96%, rgb(255 255 255 / 0.14), transparent 50%),
      linear-gradient(165deg, #f2cdd9 0%, #e6bfd0 45%, #dcaec2 100%);
  }

  .scene-no-1::before {
    opacity: 0.42;
    background: linear-gradient(180deg, rgb(91 82 89 / 0.16) 0%, rgb(83 76 85 / 0.24) 100%);
  }

  .scene-no-2 {
    background:
      radial-gradient(52rem 33rem at -8% 0%, rgb(255 229 239 / 0.22), transparent 45%),
      radial-gradient(48rem 34rem at 104% 96%, rgb(255 214 228 / 0.24), transparent 50%),
      linear-gradient(165deg, #efb8cc 0%, #df97b4 46%, #cc7f9e 100%);
  }

  .scene-no-2::before {
    opacity: 0.34;
    background: linear-gradient(180deg, rgb(103 62 84 / 0.2) 0%, rgb(87 45 68 / 0.36) 100%);
  }

  .scene-no-3,
  .scene-no-4 {
    background:
      radial-gradient(54rem 40rem at 50% -12%, rgb(255 88 88 / 0.18) 0%, transparent 55%),
      radial-gradient(48rem 34rem at 50% 105%, rgb(91 14 24 / 0.65) 0%, transparent 68%),
      linear-gradient(175deg, #260509 0%, #48080e 38%, #77111a 68%, #2b0608 100%);
  }

  .scene-no-3::before,
  .scene-no-4::before {
    opacity: 0.32;
    background:
      linear-gradient(180deg, rgb(0 0 0 / 0.26) 0%, rgb(0 0 0 / 0.44) 100%),
      radial-gradient(30rem 22rem at 76% 8%, rgb(255 81 81 / 0.26), transparent 74%);
  }

  .scene-yes {
    background:
      radial-gradient(54rem 36rem at -8% 0%, rgb(255 255 255 / 0.26), transparent 46%),
      radial-gradient(52rem 34rem at 104% 96%, rgb(255 250 252 / 0.32), transparent 50%),
      linear-gradient(165deg, #ffe8f1 0%, #ffd8e9 44%, #f9c9df 100%);
  }

  .app-shell.peace-restoring {
    background:
      radial-gradient(52rem 34rem at -8% 0%, rgb(255 255 255 / 0.24), transparent 46%),
      radial-gradient(50rem 32rem at 104% 96%, rgb(255 246 250 / 0.3), transparent 50%),
      linear-gradient(165deg, #ffe6f0 0%, #ffd6e7 45%, #f8c6dd 100%);
  }

  .app-shell.peace-restoring .scene-cracks,
  .app-shell.peace-restoring .scene-debris {
    opacity: 0;
  }

  .scene-flash {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    background: linear-gradient(0deg, rgb(255 54 54 / 0), rgb(255 54 54 / 0.52) 48%, rgb(255 54 54 / 0));
  }

  .scene-flash-active {
    animation: flash 360ms ease-out;
  }

  .scene-cracks {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    transition: opacity 360ms ease;
  }

  .scene-cracks-active {
    opacity: 1;
  }

  .scene-cracks::before,
  .scene-cracks::after {
    content: '';
    position: absolute;
    border-top: 1px solid rgb(255 208 218 / 0.45);
    opacity: 0.7;
  }

  .scene-cracks::before {
    top: 31%;
    left: 11%;
    width: 37%;
    transform: rotate(-19deg);
  }

  .scene-cracks::after {
    bottom: 26%;
    right: 13%;
    width: 44%;
    transform: rotate(17deg);
  }

  .crack-fragment {
    position: absolute;
    border-top: 1px solid rgb(255 220 224 / 0.52);
    transform-origin: left center;
    opacity: 0.82;
  }

  .crack-fragment-1 {
    top: 18%;
    right: 26%;
    width: 23%;
    transform: rotate(34deg);
  }

  .crack-fragment-2 {
    bottom: 33%;
    left: 20%;
    width: 28%;
    transform: rotate(-28deg);
  }

  .crack-fragment-3 {
    top: 58%;
    right: 18%;
    width: 19%;
    transform: rotate(-12deg);
  }

  .scene-no-3 .scene-cracks::before,
  .scene-no-3 .scene-cracks::after,
  .scene-no-4 .scene-cracks::before,
  .scene-no-4 .scene-cracks::after,
  .scene-no-3 .crack-fragment,
  .scene-no-4 .crack-fragment {
    border-top-color: rgb(255 171 171 / 0.66);
    border-top-width: 2px;
    filter: drop-shadow(0 0 8px rgb(255 88 88 / 0.22));
  }

  .scene-debris {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    transition: opacity 400ms ease;
  }

  .scene-debris-active {
    opacity: 1;
  }

  .debris-particle {
    position: absolute;
    top: -10%;
    left: var(--debris-left);
    width: var(--debris-size);
    height: var(--debris-size);
    border-radius: 2px;
    background: linear-gradient(180deg, rgb(255 208 208 / 0.7), rgb(99 30 35 / 0.45));
    box-shadow: 0 0 8px rgb(255 96 96 / 0.28);
    opacity: 0;
    animation: debris-float var(--debris-duration) linear infinite;
    animation-delay: var(--debris-delay);
    transform: translate3d(0, -6vh, 0);
  }

  .mew-shell {
    @apply relative mx-auto w-full max-w-[31rem] text-center;
  }

  .question-card {
    @apply rounded-card border border-white/70 bg-white/40 px-card pb-7 pt-6 shadow-glow backdrop-blur-md;
  }

  .question-chip-wrap {
    @apply mb-3 min-h-[2rem];
  }

  .question-chip-wrap.visible {
    animation: result-content-in 320ms ease both;
  }

  .question-chip {
    @apply inline-flex items-center rounded-full border border-white/80 bg-white/90 px-4 py-1 text-sm font-semibold text-primary shadow-soft;
  }

  .hero-frame {
    @apply relative mx-auto w-full max-w-[23rem] overflow-visible rounded-[2rem] border border-white/80 bg-white/45 p-1.5;
    box-shadow: 0 16px 36px -28px rgb(125 36 67 / 0.68);
    aspect-ratio: 1 / 1;
  }

  .hero-media {
    @apply h-full w-full rounded-[1.7rem] border border-white/70 object-cover object-center;
    background: linear-gradient(135deg, #f5cfc8, #f8e2d7);
  }

  .hero-fallback-emoji {
    @apply flex h-full w-full items-center justify-center rounded-[1.7rem] border border-white/70 bg-white/65 text-[4.3rem];
  }

  .hero-sticker {
    @apply absolute -bottom-3 right-0 rounded-full border border-white/85 bg-white/95 px-4 py-1.5 text-xs font-semibold uppercase tracking-[0.06em] text-primary shadow-soft;
    transform: rotate(5deg);
  }

  .headline-main {
    @apply block text-balance text-[2.55rem] font-semibold leading-[1.02] text-ink sm:text-[3rem];
  }

  .headline-accent {
    @apply relative mt-1 inline-block text-[2.15rem] font-bold leading-[1] text-primary sm:text-[2.45rem];
  }

  .mini-chaos-note {
    @apply mx-auto inline-flex rounded-full border border-primary/25 bg-white/80 px-3 py-1 text-sm font-semibold text-primary shadow-soft;
  }

  .badge-pill {
    @apply inline-flex items-center gap-2 rounded-full border border-white/70 bg-white/65 px-5 py-2 text-sm font-semibold uppercase tracking-[0.13em] text-primary shadow-[0_16px_32px_-24px_rgba(118,26,65,0.8)] backdrop-blur-sm;
  }

  .compatibility-line {
    @apply text-[1.22rem] font-semibold text-ink sm:text-[1.33rem];
  }

  .compatibility-reason {
    @apply mt-1 text-[1.02rem] font-medium text-muted;
  }

  .yes-transitioning.question-card {
    animation: glow 820ms cubic-bezier(0.2, 0.86, 0.3, 1) both;
  }

  .yes-transitioning .hero-media,
  .yes-transitioning .hero-fallback-emoji {
    filter: saturate(1.1);
    transform: scale(1.015);
    transition: transform 360ms ease, filter 360ms ease;
  }

  .paw-burst {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 0;
    height: 0;
    pointer-events: none;
    z-index: 4;
  }

  .paw-particle {
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
    font-size: var(--paw-size);
    line-height: 1;
    transform: translate(-50%, -50%) rotate(0deg) scale(0.55);
    will-change: transform, opacity;
  }

  .paw-burst-active .paw-particle {
    animation: paw-burst 560ms cubic-bezier(0.2, 0.85, 0.2, 1.04) both;
    animation-delay: calc(var(--paw-delay) + 180ms);
  }

  .text-glitch {
    animation: glitch 1.8s steps(2, end) infinite;
  }

  .text-glitch-subtle {
    animation: glitch 2.5s steps(2, end) infinite;
  }

  .result-reveal {
    opacity: 0;
    animation: result-content-in 460ms ease both;
    animation-delay: var(--result-delay, 0ms);
  }

  .result-delay-1 {
    --result-delay: 60ms;
  }

  .result-delay-2 {
    --result-delay: 110ms;
  }

  .result-delay-3 {
    --result-delay: 180ms;
  }

  .result-delay-4 {
    --result-delay: 240ms;
  }

  .result-delay-5 {
    --result-delay: 300ms;
  }

  .result-delay-6 {
    --result-delay: 360ms;
  }

  .result-delay-7 {
    --result-delay: 430ms;
  }
}

.animate-card-in {
  animation: card-enter 560ms cubic-bezier(0.21, 0.85, 0.26, 1.02) both;
}

.animate-result-pop {
  animation: result-pop 670ms cubic-bezier(0.2, 1.08, 0.28, 1) both;
}

.card-shake-soft {
  --shake-x: 3px;
  --shake-y: 2px;
  animation: shake 320ms ease-in-out;
}

.card-shake-medium {
  --shake-x: 6px;
  --shake-y: 4px;
  animation: shake 360ms ease-in-out;
}

.card-shake-hard {
  --shake-x: 9px;
  --shake-y: 6px;
  animation: shake 420ms ease-in-out;
}

.screen-shake-soft {
  --shake-x: 3px;
  --shake-y: 2px;
  animation: shake 300ms linear;
}

.screen-shake-medium {
  --shake-x: 5px;
  --shake-y: 3px;
  animation: shake 360ms linear;
}

.screen-shake-hard {
  --shake-x: 8px;
  --shake-y: 5px;
  animation: shake 420ms linear;
}

@keyframes card-enter {
  from {
    opacity: 0;
    transform: translateY(18px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes result-pop {
  0% {
    opacity: 0;
    transform: translateY(14px) scale(0.95);
  }
  58% {
    opacity: 1;
    transform: translateY(-2px) scale(1.01);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes shake {
  0%,
  100% {
    transform: translate3d(0, 0, 0);
  }
  20% {
    transform: translate3d(calc(var(--shake-x, 4px) * -1), calc(var(--shake-y, 2px) * -1), 0);
  }
  40% {
    transform: translate3d(var(--shake-x, 4px), var(--shake-y, 2px), 0);
  }
  60% {
    transform: translate3d(calc(var(--shake-x, 4px) * -0.7), var(--shake-y, 2px), 0);
  }
  80% {
    transform: translate3d(calc(var(--shake-x, 4px) * 0.55), calc(var(--shake-y, 2px) * -1), 0);
  }
}

@keyframes flash {
  0% {
    opacity: 0;
  }
  26% {
    opacity: 0.85;
  }
  100% {
    opacity: 0;
  }
}

@keyframes debris-float {
  0% {
    opacity: 0;
    transform: translate3d(0, -4vh, 0) rotate(0deg);
  }
  12% {
    opacity: 0.8;
  }
  85% {
    opacity: 0.3;
  }
  100% {
    opacity: 0;
    transform: translate3d(var(--debris-drift), 112vh, 0) rotate(230deg);
  }
}

@keyframes glow {
  0% {
    box-shadow: 0 16px 32px -26px rgb(240 130 170 / 0.2);
    transform: translateY(0) scale(1);
  }
  50% {
    box-shadow: 0 24px 48px -22px rgb(255 166 196 / 0.9);
    transform: translateY(-2px) scale(1.015);
  }
  100% {
    box-shadow: 0 20px 40px -24px rgb(245 132 178 / 0.45);
    transform: translateY(0) scale(1.01);
  }
}

@keyframes paw-burst {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(0deg) scale(0.55);
  }
  20% {
    opacity: 0.9;
  }
  100% {
    opacity: 0;
    transform: translate(calc(var(--paw-x) - 50%), calc(var(--paw-y) - 50%)) rotate(var(--paw-rotate)) scale(1.03);
  }
}

@keyframes glitch {
  0%,
  100% {
    text-shadow: 0 0 0 transparent;
    transform: translate3d(0, 0, 0);
  }
  20% {
    text-shadow:
      1px 0 0 rgb(255 130 130 / 0.7),
      -1px 0 0 rgb(255 196 196 / 0.45);
    transform: translate3d(0.4px, -0.4px, 0);
  }
  40% {
    text-shadow:
      -1px 0 0 rgb(255 110 110 / 0.78),
      1px 0 0 rgb(255 205 205 / 0.5);
    transform: translate3d(-0.4px, 0.2px, 0);
  }
  60% {
    text-shadow:
      1px 0 0 rgb(255 112 112 / 0.62),
      -1px 0 0 rgb(255 205 205 / 0.43);
    transform: translate3d(0.3px, 0, 0);
  }
}

@keyframes result-content-in {
  0% {
    opacity: 0;
    transform: translateY(8px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 640px) {
  .question-card {
    padding-top: 1.2rem;
    padding-bottom: 1.4rem;
  }

  .headline-main {
    font-size: 2.12rem;
  }

  .headline-accent {
    font-size: 1.9rem;
  }
}

@media (prefers-reduced-motion: reduce) {
  .animate-card-in,
  .animate-result-pop,
  .scene-flash-active,
  .debris-particle,
  .card-shake-soft,
  .card-shake-medium,
  .card-shake-hard,
  .screen-shake-soft,
  .screen-shake-medium,
  .screen-shake-hard,
  .yes-transitioning.question-card,
  .paw-burst-active .paw-particle,
  .text-glitch,
  .text-glitch-subtle,
  .result-reveal {
    animation: none !important;
  }

  *,
  *::before,
  *::after {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
